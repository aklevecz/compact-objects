{"mappings":"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","sources":["virtualjoystick.js"],"sourcesContent":["var VirtualJoystick = function (opts) {\n  opts = opts || {};\n  this._container = opts.container || document.body;\n  this._strokeStyle = opts.strokeStyle || \"cyan\";\n  this._stickEl = opts.stickElement || this._buildJoystickStick();\n  this._baseEl = opts.baseElement || this._buildJoystickBase();\n  this._mouseSupport =\n    opts.mouseSupport !== undefined ? opts.mouseSupport : false;\n  this._stationaryBase = opts.stationaryBase || false;\n  this._baseX = this._stickX = opts.baseX || 0;\n  this._baseY = this._stickY = opts.baseY || 0;\n  this._limitStickTravel = opts.limitStickTravel || false;\n  this._stickRadius = opts.stickRadius !== undefined ? opts.stickRadius : 100;\n  this._useCssTransform =\n    opts.useCssTransform !== undefined ? opts.useCssTransform : false;\n\n  this._container.style.position = \"relative\";\n\n  this._container.appendChild(this._baseEl);\n  this._baseEl.style.position = \"absolute\";\n  this._baseEl.style.display = \"none\";\n  this._container.appendChild(this._stickEl);\n  this._stickEl.style.position = \"absolute\";\n  this._stickEl.style.display = \"none\";\n\n  this._pressed = false;\n  this._touchIdx = null;\n\n  if (this._stationaryBase === true) {\n    this._baseEl.style.display = \"\";\n    this._baseEl.style.left = this._baseX - this._baseEl.width / 2 + \"px\";\n    this._baseEl.style.top = this._baseY - this._baseEl.height / 2 + \"px\";\n  }\n\n  this._transform = this._useCssTransform\n    ? this._getTransformProperty()\n    : false;\n  this._has3d = this._check3D();\n\n  var __bind = function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  };\n  this._$onTouchStart = __bind(this._onTouchStart, this);\n  this._$onTouchEnd = __bind(this._onTouchEnd, this);\n  this._$onTouchMove = __bind(this._onTouchMove, this);\n  this._container.addEventListener(\"touchstart\", this._$onTouchStart, false);\n  this._container.addEventListener(\"touchend\", this._$onTouchEnd, false);\n  this._container.addEventListener(\"touchmove\", this._$onTouchMove, false);\n  if (this._mouseSupport) {\n    this._$onMouseDown = __bind(this._onMouseDown, this);\n    this._$onMouseUp = __bind(this._onMouseUp, this);\n    this._$onMouseMove = __bind(this._onMouseMove, this);\n    this._container.addEventListener(\"mousedown\", this._$onMouseDown, false);\n    this._container.addEventListener(\"mouseup\", this._$onMouseUp, false);\n    this._container.addEventListener(\"mousemove\", this._$onMouseMove, false);\n  }\n};\n\nVirtualJoystick.prototype.destroy = function () {\n  this._container.removeChild(this._baseEl);\n  this._container.removeChild(this._stickEl);\n\n  this._container.removeEventListener(\"touchstart\", this._$onTouchStart, false);\n  this._container.removeEventListener(\"touchend\", this._$onTouchEnd, false);\n  this._container.removeEventListener(\"touchmove\", this._$onTouchMove, false);\n  if (this._mouseSupport) {\n    this._container.removeEventListener(\"mouseup\", this._$onMouseUp, false);\n    this._container.removeEventListener(\"mousedown\", this._$onMouseDown, false);\n    this._container.removeEventListener(\"mousemove\", this._$onMouseMove, false);\n  }\n};\n\n/**\n * @returns {Boolean} true if touchscreen is currently available, false otherwise\n */\nVirtualJoystick.touchScreenAvailable = function () {\n  return \"createTouch\" in document ? true : false;\n};\n\n/**\n * microevents.js - https://github.com/jeromeetienne/microevent.js\n */\n(function (destObj) {\n  destObj.addEventListener = function (event, fct) {\n    if (this._events === undefined) this._events = {};\n    this._events[event] = this._events[event] || [];\n    this._events[event].push(fct);\n    return fct;\n  };\n  destObj.removeEventListener = function (event, fct) {\n    if (this._events === undefined) this._events = {};\n    if (event in this._events === false) return;\n    this._events[event].splice(this._events[event].indexOf(fct), 1);\n  };\n  destObj.dispatchEvent = function (event /* , args... */) {\n    if (this._events === undefined) this._events = {};\n    if (this._events[event] === undefined) return;\n    var tmpArray = this._events[event].slice();\n    for (var i = 0; i < tmpArray.length; i++) {\n      var result = tmpArray[i].apply(\n        this,\n        Array.prototype.slice.call(arguments, 1)\n      );\n      if (result !== undefined) return result;\n    }\n    return undefined;\n  };\n})(VirtualJoystick.prototype);\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\t\t\t\t\t\t\t\t\t//\n//////////////////////////////////////////////////////////////////////////////////\n\nVirtualJoystick.prototype.deltaX = function () {\n  return this._stickX - this._baseX;\n};\nVirtualJoystick.prototype.deltaY = function () {\n  return this._stickY - this._baseY;\n};\n\nVirtualJoystick.prototype.up = function () {\n  if (this._pressed === false) return false;\n  var deltaX = this.deltaX();\n  var deltaY = this.deltaY();\n  if (deltaY >= 0) return false;\n  if (Math.abs(deltaX) > 2 * Math.abs(deltaY)) return false;\n  return true;\n};\nVirtualJoystick.prototype.down = function () {\n  if (this._pressed === false) return false;\n  var deltaX = this.deltaX();\n  var deltaY = this.deltaY();\n  if (deltaY <= 0) return false;\n  if (Math.abs(deltaX) > 2 * Math.abs(deltaY)) return false;\n  return true;\n};\nVirtualJoystick.prototype.right = function () {\n  if (this._pressed === false) return false;\n  var deltaX = this.deltaX();\n  var deltaY = this.deltaY();\n  if (deltaX <= 0) return false;\n  if (Math.abs(deltaY) > 2 * Math.abs(deltaX)) return false;\n  return true;\n};\nVirtualJoystick.prototype.left = function () {\n  if (this._pressed === false) return false;\n  var deltaX = this.deltaX();\n  var deltaY = this.deltaY();\n  if (deltaX >= 0) return false;\n  if (Math.abs(deltaY) > 2 * Math.abs(deltaX)) return false;\n  return true;\n};\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\t\t\t\t\t\t\t\t\t//\n//////////////////////////////////////////////////////////////////////////////////\n\nVirtualJoystick.prototype._onUp = function () {\n  this._pressed = false;\n  this._stickEl.style.display = \"none\";\n\n  if (this._stationaryBase == false) {\n    this._baseEl.style.display = \"none\";\n\n    this._baseX = this._baseY = 0;\n    this._stickX = this._stickY = 0;\n  }\n};\n\nVirtualJoystick.prototype._onDown = function (x, y) {\n  this._pressed = true;\n  if (this._stationaryBase == false) {\n    this._baseX = x;\n    this._baseY = y;\n    this._baseEl.style.display = \"\";\n    this._move(\n      this._baseEl.style,\n      this._baseX - this._baseEl.width / 2,\n      this._baseY - this._baseEl.height / 2\n    );\n  }\n\n  this._stickX = x;\n  this._stickY = y;\n\n  if (this._limitStickTravel === true) {\n    var deltaX = this.deltaX();\n    var deltaY = this.deltaY();\n    var stickDistance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    if (stickDistance > this._stickRadius) {\n      var stickNormalizedX = deltaX / stickDistance;\n      var stickNormalizedY = deltaY / stickDistance;\n\n      this._stickX = stickNormalizedX * this._stickRadius + this._baseX;\n      this._stickY = stickNormalizedY * this._stickRadius + this._baseY;\n    }\n  }\n\n  this._stickEl.style.display = \"\";\n  this._move(\n    this._stickEl.style,\n    this._stickX - this._stickEl.width / 2,\n    this._stickY - this._stickEl.height / 2\n  );\n};\n\nVirtualJoystick.prototype._onMove = function (x, y) {\n  if (this._pressed === true) {\n    this._stickX = x;\n    this._stickY = y;\n\n    if (this._limitStickTravel === true) {\n      var deltaX = this.deltaX();\n      var deltaY = this.deltaY();\n      var stickDistance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n      if (stickDistance > this._stickRadius) {\n        var stickNormalizedX = deltaX / stickDistance;\n        var stickNormalizedY = deltaY / stickDistance;\n\n        this._stickX = stickNormalizedX * this._stickRadius + this._baseX;\n        this._stickY = stickNormalizedY * this._stickRadius + this._baseY;\n      }\n    }\n\n    this._move(\n      this._stickEl.style,\n      this._stickX - this._stickEl.width / 2,\n      this._stickY - this._stickEl.height / 2\n    );\n  }\n};\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\tbind touch events (and mouse events for debug)\t\t\t//\n//////////////////////////////////////////////////////////////////////////////////\n\nVirtualJoystick.prototype._onMouseUp = function (event) {\n  return this._onUp();\n};\n\nVirtualJoystick.prototype._onMouseDown = function (event) {\n  event.preventDefault();\n  var x = event.clientX;\n  var y = event.clientY;\n  return this._onDown(x, y);\n};\n\nVirtualJoystick.prototype._onMouseMove = function (event) {\n  var x = event.clientX;\n  var y = event.clientY;\n  return this._onMove(x, y);\n};\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\tcomment\t\t\t\t\t\t\t\t//\n//////////////////////////////////////////////////////////////////////////////////\n\nVirtualJoystick.prototype._onTouchStart = function (event) {\n  // if there is already a touch inprogress do nothing\n  if (this._touchIdx !== null) return;\n\n  // notify event for validation\n  var isValid = this.dispatchEvent(\"touchStartValidation\", event);\n  if (isValid === false) return;\n\n  // dispatch touchStart\n  this.dispatchEvent(\"touchStart\", event);\n\n  event.preventDefault();\n  // get the first who changed\n  var touch = event.changedTouches[0];\n  // set the touchIdx of this joystick\n  this._touchIdx = touch.identifier;\n\n  // forward the action\n  var x = touch.pageX;\n  var y = touch.pageY;\n  return this._onDown(x, y);\n};\n\nVirtualJoystick.prototype._onTouchEnd = function (event) {\n  // if there is no touch in progress, do nothing\n  if (this._touchIdx === null) return;\n\n  // dispatch touchEnd\n  this.dispatchEvent(\"touchEnd\", event);\n\n  // try to find our touch event\n  var touchList = event.changedTouches;\n  for (\n    var i = 0;\n    i < touchList.length && touchList[i].identifier !== this._touchIdx;\n    i++\n  );\n  // if touch event isnt found,\n  if (i === touchList.length) return;\n\n  // reset touchIdx - mark it as no-touch-in-progress\n  this._touchIdx = null;\n\n  //??????\n  // no preventDefault to get click event on ios\n  event.preventDefault();\n\n  return this._onUp();\n};\n\nVirtualJoystick.prototype._onTouchMove = function (event) {\n  // if there is no touch in progress, do nothing\n  if (this._touchIdx === null) return;\n\n  // try to find our touch event\n  var touchList = event.changedTouches;\n  for (\n    var i = 0;\n    i < touchList.length && touchList[i].identifier !== this._touchIdx;\n    i++\n  );\n  // if touch event with the proper identifier isnt found, do nothing\n  if (i === touchList.length) return;\n  var touch = touchList[i];\n\n  event.preventDefault();\n\n  var x = touch.pageX;\n  var y = touch.pageY;\n  return this._onMove(x, y);\n};\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\tbuild default stickEl and baseEl\t\t\t\t//\n//////////////////////////////////////////////////////////////////////////////////\n\n/**\n * build the canvas for joystick base\n */\nVirtualJoystick.prototype._buildJoystickBase = function () {\n  var canvas = document.createElement(\"canvas\");\n  canvas.width = 126;\n  canvas.height = 126;\n\n  var ctx = canvas.getContext(\"2d\");\n  ctx.beginPath();\n  ctx.strokeStyle = this._strokeStyle;\n  ctx.lineWidth = 6;\n  ctx.arc(canvas.width / 2, canvas.width / 2, 40, 0, Math.PI * 2, true);\n  ctx.stroke();\n\n  ctx.beginPath();\n  ctx.strokeStyle = this._strokeStyle;\n  ctx.lineWidth = 2;\n  ctx.arc(canvas.width / 2, canvas.width / 2, 60, 0, Math.PI * 2, true);\n  ctx.stroke();\n\n  return canvas;\n};\n\n/**\n * build the canvas for joystick stick\n */\nVirtualJoystick.prototype._buildJoystickStick = function () {\n  var canvas = document.createElement(\"canvas\");\n  canvas.width = 86;\n  canvas.height = 86;\n  var ctx = canvas.getContext(\"2d\");\n  ctx.beginPath();\n  ctx.strokeStyle = this._strokeStyle;\n  ctx.lineWidth = 6;\n  ctx.arc(canvas.width / 2, canvas.width / 2, 40, 0, Math.PI * 2, true);\n  ctx.stroke();\n  return canvas;\n};\n\n//////////////////////////////////////////////////////////////////////////////////\n//\t\tmove using translate3d method with fallback to translate > 'top' and 'left'\n//      modified from https://github.com/component/translate and dependents\n//////////////////////////////////////////////////////////////////////////////////\n\nVirtualJoystick.prototype._move = function (style, x, y) {\n  if (this._transform) {\n    if (this._has3d) {\n      style[this._transform] = \"translate3d(\" + x + \"px,\" + y + \"px, 0)\";\n    } else {\n      style[this._transform] = \"translate(\" + x + \"px,\" + y + \"px)\";\n    }\n  } else {\n    style.left = x + \"px\";\n    style.top = y + \"px\";\n  }\n};\n\nVirtualJoystick.prototype._getTransformProperty = function () {\n  var styles = [\n    \"webkitTransform\",\n    \"MozTransform\",\n    \"msTransform\",\n    \"OTransform\",\n    \"transform\",\n  ];\n\n  var el = document.createElement(\"p\");\n  var style;\n\n  for (var i = 0; i < styles.length; i++) {\n    style = styles[i];\n    if (null != el.style[style]) {\n      return style;\n    }\n  }\n};\n\nVirtualJoystick.prototype._check3D = function () {\n  var prop = this._getTransformProperty();\n  // IE8<= doesn't have `getComputedStyle`\n  if (!prop || !window.getComputedStyle) return (module.exports = false);\n\n  var map = {\n    webkitTransform: \"-webkit-transform\",\n    OTransform: \"-o-transform\",\n    msTransform: \"-ms-transform\",\n    MozTransform: \"-moz-transform\",\n    transform: \"transform\",\n  };\n\n  // from: https://gist.github.com/lorenzopolidori/3794226\n  var el = document.createElement(\"div\");\n  el.style[prop] = \"translate3d(1px,1px,1px)\";\n  document.body.insertBefore(el, null);\n  var val = getComputedStyle(el).getPropertyValue(map[prop]);\n  document.body.removeChild(el);\n  var exports = null != val && val.length && \"none\" != val;\n  return exports;\n};\n"],"names":["VirtualJoystick","opts","this","_container","container","document","body","_strokeStyle","strokeStyle","_stickEl","stickElement","_buildJoystickStick","_baseEl","baseElement","_buildJoystickBase","_mouseSupport","undefined","mouseSupport","_stationaryBase","stationaryBase","_baseX","_stickX","baseX","_baseY","_stickY","baseY","_limitStickTravel","limitStickTravel","_stickRadius","stickRadius","_useCssTransform","useCssTransform","style","position","appendChild","display","_pressed","_touchIdx","left","width","top","height","_transform","_getTransformProperty","_has3d","_check3D","__bind","fn","me","apply","arguments","_$onTouchStart","_onTouchStart","_$onTouchEnd","_onTouchEnd","_$onTouchMove","_onTouchMove","addEventListener","_$onMouseDown","_onMouseDown","_$onMouseUp","_onMouseUp","_$onMouseMove","_onMouseMove","prototype","destroy","removeChild","removeEventListener","touchScreenAvailable","destObj","event","fct","_events","push","splice","indexOf","dispatchEvent","tmpArray","slice","i","length","result","Array","call","deltaX","deltaY","up","Math","abs","down","right","_onUp","_onDown","x","y","_move","stickDistance","sqrt","stickNormalizedX","stickNormalizedY","_onMove","preventDefault","clientX","clientY","touch","changedTouches","identifier","pageX","pageY","touchList","canvas","createElement","ctx","getContext","beginPath","lineWidth","arc","PI","stroke","styles","el","prop","window","getComputedStyle","module","exports","insertBefore","val","getPropertyValue","webkitTransform","OTransform","msTransform","MozTransform","transform"],"version":3,"file":"index.66e12c17.js.map"}